---
title: "Shiny App Presentation"  
subtitle: "Reproducible Pitch for the 9th course of the JHU Data Science specialization."
author: "Author: FG"
date: "2023-01-05"
output:
  ioslides_presentation:
    css: styles.css
    incremental: true
    widescreen: true
    smaller: true
  beamer_presentation: default
  slidy_presentation: default
always_allow_html: yes  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	fig.align = "center",
	message = FALSE,
	warning = FALSE,
	comment = "."
)
```

## Description of the Shiny App

This is the final project for the 9th course of the JHU Data Science specialization: **Shiny Application and Reproducible Pitch**.

The purpose of this app is to provide the user with information about the type of pathogens that are acting in certain infectious syndromes for specific countries.

For example, *bloodstream infections* can be affected by several types of pathogens, but the *salmonella pathogen* is the most deadly one in countries such as Italy. Pathogens are listed by the most affecting deaths rate in world countries.

The app provides the rate of **deaths** and **years of life lost (YLLs)** due to infectious syndromes and specific pathogens. The results are shown in a map with a country polygon and a barplot or a boxplot showing the highest level of deadliest pathogens by infectious syndrome, either by deaths or YLLs rates respectively.

## Data Source

Data for making this app is from the [IHME website](https://ghdx.healthdata.org/) at:

<https://ghdx.healthdata.org/record/ihme-data/global-mortality-33-bacterial-pathogens-estimates-2019>

Researchers at IHME and the University of Oxford produced estimates of deaths and years of life lost (YLLs) associated with bacterial infections caused by 33 pathogens across 204 locations in 2019.

To download the data into RStudio, this code snipped can be used:

```{r eval=FALSE}
library(downloader)
url <- "https://ghdx.healthdata.org/sites/default/files/record-attached-files/
        IHME_AMR_PATHOGEN_DATA_Y2022M11D21.zip"
download(url, dest="dataset.zip", mode="wb") 
unzip ("dataset.zip", exdir = "data")
unlink("dataset.zip")
```

```{r}
load("data/pathogens.RData")
```

## How to use it

The user can select a Country, and the app will show the polygon with a centroid indicating the country's name. To investigate more the rate of deaths or the YLLs for a specific country, the user can select the type of infectious syndromes and the barplot will show the type of pathogens which are the most dangerous as life threatening.

The app starts with Italy and bloodstream infections showing the life threatening pathogens as deaths rates. When different selection is made the user is required to click the button **Search** for updating the visualization.

A radio button is used to switch between "Deaths" or "YLLs" rates, so if one is selected the other one cannot be chosen. The *deaths* selection will show a barplot, while a *YLLs* selection will show a boxplot.

Try it: <https://federica-gazzelloni.shinyapps.io/Pathogens2019_Shiny_App/>

## Data Visualization

To give an overview of the impact of the deadliest pathogens for all countries a boxplot shows here the difference among pathogens affecting *All infectious syndromes* versus *Bloodstream infections*.

```{r echo=FALSE}
# Load data 
source("data/tidydata.R")
```


```{r echo=FALSE}
filter(centroids_full)%>%
  filter(measure_name %in% "YLLs") %>%
  filter(infectious_syndrome %in% c("All infectious syndromes",
                                    "Bloodstream infections")) %>%
  group_by(location_name,pathogen) %>%
  mutate(n=n(),pathogen=as.factor(pathogen)) %>%
  mutate(max=max(n))%>%
  ungroup()%>%
  mutate(pathogen=reorder(pathogen,-val)) %>%
  ggplot(aes(x=1/val,y=fct_reorder(pathogen,max)))+
  geom_boxplot(aes(fill=infectious_syndrome))+
  scale_x_log10()+
  labs(title="All infectious syndromes versus Bloodstream infections",
       subtitle="the deadliest pathogens for all countries",
       fill="Infectious Syndrome",x="Rate Values (logtranf)",y="Pathogens")+
  scale_fill_manual(values =RColorBrewer::brewer.pal(12,"Set3"))
```
